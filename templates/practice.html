<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practice - Learning Machine</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css" rel="stylesheet">
    <style>
        .practice-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 0;
        }
        .CodeMirror {
            height: 400px;
            border-radius: 10px;
            font-size: 14px;
        }
        .output-panel {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 1rem;
            min-height: 200px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        .exercise-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: none;
            border-radius: 15px;
        }
        .exercise-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .exercise-card.active {
            border: 2px solid #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }
        .difficulty-badge {
            font-size: 0.8rem;
            padding: 0.25rem 0.5rem;
        }
        .difficulty-beginner { background-color: #28a745; }
        .difficulty-intermediate { background-color: #ffc107; color: #000; }
        .difficulty-advanced { background-color: #dc3545; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="fas fa-brain me-2"></i>Learning Machine
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('lessons') }}">Lessons</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('resources') }}">Resources</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('practice') }}">Practice</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('progress') }}">Progress</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Practice Header -->
    <section class="practice-header">
        <div class="container text-center">
            <h1 class="display-4 fw-bold mb-4">Interactive Practice</h1>
            <p class="lead">Write, run, and test your Python code in real-time</p>
        </div>
    </section>

    <!-- Practice Content -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <!-- Exercise Selection -->
                <div class="col-lg-4 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-list me-2"></i>Practice Exercises</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="exerciseSelect" class="form-label">Choose an exercise:</label>
                                <select class="form-select" id="exerciseSelect">
                                    <option value="">Select an exercise...</option>
                                    <option value="hello_world">Hello World</option>
                                    <option value="variables">Variables and Data Types</option>
                                    <option value="loops">Loops and Control Flow</option>
                                    <option value="functions">Functions</option>
                                    <option value="lists">Lists and Arrays</option>
                                    <option value="dictionaries">Dictionaries</option>
                                    <option value="classes">Classes and Objects</option>
                                    <option value="file_io">File I/O</option>
                                    <option value="exceptions">Exception Handling</option>
                                </select>
                            </div>
                            
                            <div id="exerciseDescription" class="d-none">
                                <h6>Exercise Description:</h6>
                                <p id="exerciseText" class="text-muted"></p>
                                <div class="mb-3">
                                    <span class="badge" id="difficultyBadge"></span>
                                </div>
                                <button class="btn btn-outline-primary btn-sm" onclick="loadExercise()">
                                    <i class="fas fa-download me-1"></i>Load Exercise
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Examples -->
                    <div class="card mt-4">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-lightning me-2"></i>Quick Examples</h5>
                        </div>
                        <div class="card-body">
                            <div class="d-grid gap-2">
                                <button class="btn btn-outline-secondary btn-sm" onclick="loadExample('hello')">
                                    Hello World
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="loadExample('calculator')">
                                    Simple Calculator
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="loadExample('fibonacci')">
                                    Fibonacci Sequence
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="loadExample('sort')">
                                    List Sorting
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Code Editor -->
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-code me-2"></i>Code Editor</h5>
                            <div>
                                <button class="btn btn-success btn-sm" onclick="runCode()">
                                    <i class="fas fa-play me-1"></i>Run Code
                                </button>
                                <button class="btn btn-outline-secondary btn-sm" onclick="clearCode()">
                                    <i class="fas fa-trash me-1"></i>Clear
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <textarea id="codeEditor"></textarea>
                        </div>
                    </div>

                    <!-- Output Panel -->
                    <div class="card mt-4">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-terminal me-2"></i>Output</h5>
                        </div>
                        <div class="card-body">
                            <div id="outputPanel" class="output-panel">
                                Ready to run your code! Click the "Run Code" button to execute your Python code.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Tips Section -->
    <section class="py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <h2 class="mb-4">Coding Tips</h2>
                    <div class="row g-4">
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <i class="fas fa-lightbulb text-warning mb-3" style="font-size: 2rem;"></i>
                                    <h5>Start Simple</h5>
                                    <p class="text-muted">Begin with basic examples and gradually increase complexity</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <i class="fas fa-bug text-danger mb-3" style="font-size: 2rem;"></i>
                                    <h5>Debug Carefully</h5>
                                    <p class="text-muted">Read error messages carefully - they often point to the solution</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-body">
                                    <i class="fas fa-repeat text-info mb-3" style="font-size: 2rem;"></i>
                                    <h5>Practice Regularly</h5>
                                    <p class="text-muted">Consistent practice is key to mastering programming concepts</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container text-center">
            <p>&copy; 2024 Learning Machine. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <script>
        // Initialize CodeMirror
        const editor = CodeMirror.fromTextArea(document.getElementById('codeEditor'), {
            mode: 'python',
            theme: 'monokai',
            lineNumbers: true,
            indentUnit: 4,
            autoCloseBrackets: true,
            matchBrackets: true,
            lineWrapping: true
        });

        // Set initial code
        editor.setValue('# Welcome to the Python Practice Environment!\n# Write your code below and click "Run Code" to execute it.\n\nprint("Hello, World!")');

        // Exercise data
        const exercises = {
            hello_world: {
                title: "Hello World",
                description: "Write a program that prints 'Hello, World!' to the console.",
                difficulty: "beginner",
                code: 'print("Hello, World!")'
            },
            variables: {
                title: "Variables and Data Types",
                description: "Create variables of different data types and print them.",
                difficulty: "beginner",
                code: '# Create variables of different types\nname = "Python"\nage = 30\nprice = 19.99\nis_awesome = True\n\n# Print the variables\nprint(f"Name: {name}")\nprint(f"Age: {age}")\nprint(f"Price: {price}")\nprint(f"Is Awesome: {is_awesome}")'
            },
            loops: {
                title: "Loops and Control Flow",
                description: "Use loops to print numbers from 1 to 10.",
                difficulty: "beginner",
                code: '# Print numbers from 1 to 10 using a for loop\nfor i in range(1, 11):\n    print(i)\n\n# Also try a while loop\nprint("\\nUsing while loop:")\nj = 1\nwhile j <= 10:\n    print(j)\n    j += 1'
            },
            functions: {
                title: "Functions",
                description: "Create a function that calculates the factorial of a number.",
                difficulty: "intermediate",
                code: 'def factorial(n):\n    """Calculate the factorial of a number"""\n    if n == 0 or n == 1:\n        return 1\n    else:\n        return n * factorial(n - 1)\n\n# Test the function\nresult = factorial(5)\nprint(f"Factorial of 5 is: {result}")'
            },
            lists: {
                title: "Lists and Arrays",
                description: "Create a list and perform various operations on it.",
                difficulty: "intermediate",
                code: '# Create a list\nnumbers = [1, 2, 3, 4, 5]\nprint(f"Original list: {numbers}")\n\n# Add an element\nnumbers.append(6)\nprint(f"After append: {numbers}")\n\n# Remove an element\nnumbers.remove(3)\nprint(f"After removing 3: {numbers}")\n\n# Sort the list\nnumbers.sort()\nprint(f"Sorted list: {numbers}")'
            }
        };

        // Example code snippets
        const examples = {
            hello: 'print("Hello, World!")',
            calculator: 'def add(a, b):\n    return a + b\n\ndef subtract(a, b):\n    return a - b\n\nprint(f"5 + 3 = {add(5, 3)}")\nprint(f"10 - 4 = {subtract(10, 4)}")',
            fibonacci: 'def fibonacci(n):\n    if n <= 1:\n        return n\n    return fibonacci(n-1) + fibonacci(n-2)\n\n# Print first 10 Fibonacci numbers\nfor i in range(10):\n    print(fibonacci(i), end=" ")',
            sort: 'numbers = [64, 34, 25, 12, 22, 11, 90]\nprint(f"Original: {numbers}")\n\n# Sort in ascending order\nnumbers.sort()\nprint(f"Sorted: {numbers}")\n\n# Sort in descending order\nnumbers.sort(reverse=True)\nprint(f"Reverse sorted: {numbers}")'
        };

        // Exercise selection handler
        document.getElementById('exerciseSelect').addEventListener('change', function() {
            const exerciseId = this.value;
            const descriptionDiv = document.getElementById('exerciseDescription');
            const exerciseText = document.getElementById('exerciseText');
            const difficultyBadge = document.getElementById('difficultyBadge');
            
            if (exerciseId && exercises[exerciseId]) {
                const exercise = exercises[exerciseId];
                exerciseText.textContent = exercise.description;
                difficultyBadge.textContent = exercise.difficulty.toUpperCase();
                difficultyBadge.className = `badge difficulty-${exercise.difficulty}`;
                descriptionDiv.classList.remove('d-none');
            } else {
                descriptionDiv.classList.add('d-none');
            }
        });

        // Load exercise code
        function loadExercise() {
            const exerciseId = document.getElementById('exerciseSelect').value;
            if (exerciseId && exercises[exerciseId]) {
                editor.setValue(exercises[exerciseId].code);
            }
        }

        // Load example code
        function loadExample(exampleId) {
            if (examples[exampleId]) {
                editor.setValue(examples[exampleId]);
            }
        }

        // Run code function
        function runCode() {
            const code = editor.getValue();
            const outputPanel = document.getElementById('outputPanel');
            
            outputPanel.textContent = 'Running code...';
            
            fetch('/api/run_code', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ code: code })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    outputPanel.textContent = data.output;
                    outputPanel.style.color = '#28a745';
                } else {
                    outputPanel.textContent = `Error: ${data.error}`;
                    outputPanel.style.color = '#dc3545';
                }
            })
            .catch(error => {
                outputPanel.textContent = `Error: ${error.message}`;
                outputPanel.style.color = '#dc3545';
            });
        }

        // Clear code function
        function clearCode() {
            editor.setValue('');
        }
    </script>
</body>
</html>